```python
from collections import deque

dir = [[0,1],[1,0],[0,-1],[-1,0]] #동 남 서 북  
N = int(input())
cur_dir = 0
graph = [[0]*N for _ in range(N)]
time = 0
rotate_arr = [] # 회전 배열


def inside(y,x):
    global N
    if 0<=y and y <N and 0<=x and x<N:
        return True
    return False

def rotate(dir,c):
    if c == "L": #왼쪽
        next_dir = (dir-1)%4
    else:
        next_dir = (dir+1)%4

    return next_dir

K = int(input())
for i in range(K):
    y,x = map(int,input().split())
    graph[y-1][x-1] = 1 #사과 1, 뱀의몸 2, 노방문 0 

L = int(input())
for i in range(L):
    a,b = input().split()
    rotate_arr.append((int(a),b)) #시간 ,방향

def bfs():
    global dir,time,cur_dir,graph,rotate_arr
    graph[0][0] = 2
    q = deque()
    q.append([0,0]) #머리이자 꼬리임.
    y= 0
    x= 0 

    while True:
        next_y = y + dir[cur_dir][0]
        next_x =  x + dir[cur_dir][1]
        
        if inside(next_y,next_x) and graph[next_y][next_x] != 2: #방문가능할때
            
            if graph[next_y][next_x] == 0: #사과 없을 때
                graph[next_y][next_x] = 2
                q.append([next_y,next_x])
                tail_y,tail_x = q.popleft() # 꼬리를 지워준다.
                graph[tail_y][tail_x] = 0

            elif graph[next_y][next_x] == 1: #사과 잇을때
                graph[next_y][next_x] = 2 
                q.append([next_y,next_x]) #헤드만 넣어준다.

        else: #방문 불가능할때
            time+=1
            return time # 타임을 증가시키고 return
            
            # 다음 방문을 위한 준비
        time+=1
        y,x = next_y,next_x     # x,y 위치 갱신을 안해줘서 2시간 해멤;;;;;씨발;;;;;;;;;;;;;;;;;;;;;;;;;
        if len(rotate_arr) > 0 and rotate_arr[0][0] == time: #회전할시간이면
            cur_dir = rotate(cur_dir,rotate_arr[0][1]) # cur_dir을 업데이트
            rotate_arr.pop(0)
            

bfs()
print(time)


```